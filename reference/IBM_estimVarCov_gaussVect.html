<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimates the covariance matrix of the gaussian vector (IBM) — IBM_estimVarCov_gaussVect • admix</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimates the covariance matrix of the gaussian vector (IBM) — IBM_estimVarCov_gaussVect"><meta name="description" content="Nonparametric estimation of the covariance matrix of the gaussian vector at point 'z', considering the use of Inversion - Best
Matching (IBM) method to estimate the model parameters in two-sample admixture models.
Recall that the two admixture models have respective probability density functions (pdf) l1 and l2, such that:
l1 = p1*f1 + (1-p1)g1 and l2 = p2f2 + (1-p2)*g2, where g1 and g2 are the known component densities.
Further information for the IBM approach are given in 'Details' below."><meta property="og:description" content="Nonparametric estimation of the covariance matrix of the gaussian vector at point 'z', considering the use of Inversion - Best
Matching (IBM) method to estimate the model parameters in two-sample admixture models.
Recall that the two admixture models have respective probability density functions (pdf) l1 and l2, such that:
l1 = p1*f1 + (1-p1)g1 and l2 = p2f2 + (1-p2)*g2, where g1 and g2 are the known component densities.
Further information for the IBM approach are given in 'Details' below."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/admixture-clustering.html">Clustering of unknown subpopulations in admixture models</a></li>
    <li><a class="dropdown-item" href="../articles/admixture-weight-estimation.html">Estimation of unknown elements in admixture models</a></li>
    <li><a class="dropdown-item" href="../articles/test-hypothesis.html">Hypothesis test in admixture models</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/XavierMilhaud/admix/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimates the covariance matrix of the gaussian vector (IBM)</h1>
      <small class="dont-index">Source: <a href="https://github.com/XavierMilhaud/admix/blob/main/R/IBM_estimVarCov_gaussVect.R" class="external-link"><code>R/IBM_estimVarCov_gaussVect.R</code></a></small>
      <div class="d-none name"><code>IBM_estimVarCov_gaussVect.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Nonparametric estimation of the covariance matrix of the gaussian vector at point 'z', considering the use of Inversion - Best
Matching (IBM) method to estimate the model parameters in two-sample admixture models.
Recall that the two admixture models have respective probability density functions (pdf) l1 and l2, such that:
l1 = p1*f1 + (1-p1)<em>g1 and l2 = p2</em>f2 + (1-p2)*g2, where g1 and g2 are the known component densities.
Further information for the IBM approach are given in 'Details' below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">IBM_estimVarCov_gaussVect</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">estim.obj</span>,</span>
<span>  fixed.p1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  known.p <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">sample1</span>,</span>
<span>  <span class="va">sample2</span>,</span>
<span>  min_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp.dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp.param <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Time point at which the first (related to the first parameter) underlying empirical process is looked through.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Time point at which the second (related to the second parameter) underlying empirical process is looked through.</p></dd>


<dt id="arg-estim-obj">estim.obj<a class="anchor" aria-label="anchor" href="#arg-estim-obj"></a></dt>
<dd><p>Object obtained from the estimation of the component weights related to the proportions of the
unknown component in each of the two admixture models.</p></dd>


<dt id="arg-fixed-p-">fixed.p1<a class="anchor" aria-label="anchor" href="#arg-fixed-p-"></a></dt>
<dd><p>Arbitrary value chosen by the user for the component weight related to the unknown component of the first
admixture model. Only useful for optimization when the known components of the two models are identical
(G1=G2, leading to unidimensional optimization).</p></dd>


<dt id="arg-known-p">known.p<a class="anchor" aria-label="anchor" href="#arg-known-p"></a></dt>
<dd><p>(optional, NULL by default) Numeric vector with two elements, the known (true) mixture weights.</p></dd>


<dt id="arg-sample-">sample1<a class="anchor" aria-label="anchor" href="#arg-sample-"></a></dt>
<dd><p>Observations of the first sample under study.</p></dd>


<dt id="arg-sample-">sample2<a class="anchor" aria-label="anchor" href="#arg-sample-"></a></dt>
<dd><p>Observations of the second sample under study.</p></dd>


<dt id="arg-min-size">min_size<a class="anchor" aria-label="anchor" href="#arg-min-size"></a></dt>
<dd><p>(optional, NULL by default) in the k-sample case, useful to provide the minimal size among all samples
(needed to take into account the correction factor in variance-covariance assessment). Otherwise, useless.</p></dd>


<dt id="arg-comp-dist">comp.dist<a class="anchor" aria-label="anchor" href="#arg-comp-dist"></a></dt>
<dd><p>A list with four elements corresponding to the component distributions (specified with R native names for these distributions)
involved in the two admixture models. The two first elements refer to the unknown and known components of the 1st admixture model,
and the last two ones to those of the second admixture model. If there are unknown elements, they must be specified as 'NULL' objects.
For instance, 'comp.dist' could be specified as follows: list(f1=NULL, g1='norm', f2=NULL, g2='norm').</p></dd>


<dt id="arg-comp-param">comp.param<a class="anchor" aria-label="anchor" href="#arg-comp-param"></a></dt>
<dd><p>A list with four elements corresponding to the parameters of the component distributions, each element being a list
itself. The names used in this list must correspond to the native R argument names for these distributions.
The two first elements refer to the parameters of unknown and known components of the 1st admixture model, and the last
two ones to those of the second admixture model. If there are unknown elements, they must be specified as 'NULL' objects.
For instance, 'comp.param' could be specified as follows: : list(f1=NULL, g1=list(mean=0,sd=1), f2=NULL, g2=list(mean=3,sd=1.1)).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The estimated variance-covariance matrix of the gaussian vector Z = (hat(p1),(hat(p2),Dn(z)), at location '(x,y)'.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>MilhaudPommeretSalhiVandekerkhove2024aadmix</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Xavier Milhaud <a href="mailto:xavier.milhaud.research@gmail.com">xavier.milhaud.research@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">######## Analysis by simulated data:</span></span></span>
<span class="r-in"><span><span class="co">## Simulate Gamma - Exponential admixtures :</span></span></span>
<span class="r-in"><span><span class="va">list.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="st">"gamma"</span>, g1 <span class="op">=</span> <span class="st">"exp"</span>,</span></span>
<span class="r-in"><span>                  f2 <span class="op">=</span> <span class="st">"gamma"</span>, g2 <span class="op">=</span> <span class="st">"exp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   f2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="rsimmix.html">rsimmix</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">400</span>, unknownComp_weight<span class="op">=</span><span class="fl">0.8</span>, comp.dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.comp</span><span class="op">$</span><span class="va">f1</span>,<span class="va">list.comp</span><span class="op">$</span><span class="va">g1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 comp.param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.param</span><span class="op">$</span><span class="va">f1</span>, <span class="va">list.param</span><span class="op">$</span><span class="va">g1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">mixt.data</span></span></span>
<span class="r-in"><span><span class="va">Y.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="rsimmix.html">rsimmix</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">350</span>, unknownComp_weight<span class="op">=</span><span class="fl">0.9</span>, comp.dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.comp</span><span class="op">$</span><span class="va">f2</span>,<span class="va">list.comp</span><span class="op">$</span><span class="va">g2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 comp.param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">list.param</span><span class="op">$</span><span class="va">f2</span>, <span class="va">list.param</span><span class="op">$</span><span class="va">g2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">mixt.data</span></span></span>
<span class="r-in"><span><span class="co">## Real-life setting:</span></span></span>
<span class="r-in"><span><span class="va">list.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="cn">NULL</span>, g1 <span class="op">=</span> <span class="st">"exp"</span>,</span></span>
<span class="r-in"><span>                  f2 <span class="op">=</span> <span class="cn">NULL</span>, g2 <span class="op">=</span> <span class="st">"exp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list.param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>f1 <span class="op">=</span> <span class="cn">NULL</span>, g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   f2 <span class="op">=</span> <span class="cn">NULL</span>, g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Estimate the unknown component weights in the two admixture models:</span></span></span>
<span class="r-in"><span><span class="va">estim</span> <span class="op">&lt;-</span> <span class="fu"><a href="IBM_estimProp.html">IBM_estimProp</a></span><span class="op">(</span>sample1 <span class="op">=</span><span class="va">X.sim</span>, sample2 <span class="op">=</span><span class="va">Y.sim</span>, known.prop <span class="op">=</span> <span class="cn">NULL</span>, comp.dist <span class="op">=</span> <span class="va">list.comp</span>,</span></span>
<span class="r-in"><span>                       comp.param <span class="op">=</span> <span class="va">list.param</span>, with.correction <span class="op">=</span> <span class="cn">FALSE</span>, n.integ <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">IBM_estimVarCov_gaussVect</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">X.sim</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y.sim</span><span class="op">)</span>, estim.obj <span class="op">=</span> <span class="va">estim</span>,</span></span>
<span class="r-in"><span>                          fixed.p1 <span class="op">=</span> <span class="va">estim</span><span class="op">[[</span><span class="st">"p.X.fixed"</span><span class="op">]</span><span class="op">]</span>, known.p <span class="op">=</span> <span class="cn">NULL</span>, sample1<span class="op">=</span><span class="va">X.sim</span>,</span></span>
<span class="r-in"><span>                          sample2 <span class="op">=</span> <span class="va">Y.sim</span>, min_size <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                          comp.dist <span class="op">=</span> <span class="va">list.comp</span>, comp.param <span class="op">=</span> <span class="va">list.param</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  8.1374978  28.3718607 -0.25787693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 28.3718607 146.7492622 -0.78173416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.2423617  -0.6227374  0.06692729</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xavier Milhaud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

